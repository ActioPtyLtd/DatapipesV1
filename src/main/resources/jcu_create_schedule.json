{
  "script": {
    "schema": {},
    "tasks": {
      "dumpthis": {
        "type": "dump"
      },
      "read-schedules": {
        "type": "extract",
        "behavior": "",
        "dataSource": {
          "type": "sql",
          "behavior": "",
          "jdbcDriver": "com.microsoft.sqlserver.jdbc.SQLServerDriver",
          "connect": "jdbc:sqlserver://corptestmdb01.jcu.edu.au:1433;user=mediasite_ro;password=afcfh8742Nch7y1SA",
          "query": {
            "queryTemplate": "",
            "read": "SELECT TOP 5 courseid+':'+room courseid,moduleid,room,year,startdatetime,enddatetime,duration,presenterusername,presenterfullname FROM [Mediasite].[dbo].[mediasite_activities] where presenterUsername is not null"
          }
        }
      },
      "load-folder-uuid": {
        "type": "join",
        "behavior": "",
        "iterateR": "ds => ds.value",
        "keyL": "$moduleid",
        "keyR": "$Name",
        "changeL": "$moduleid",
        "changeR": "$Id",
        "dataSource": {
          "type": "rest",
          "behavior": "simple",
          "path": "-",
          "headers": {
            "Content-Type": "application/json",
            "sfapikey": "25da71cb-4032-49b3-8fe0-11ceb5f4e3a9"
          },
          "credential": {
            "user": "ACTIO",
            "password": "actio1234"
          },
          "query": {
            "read": {
              "uri": "https://mediasiteDEV.jcu.edu.au/mediasite/api/v1/Folders?$skip=0&$top=100000"
            }
          }
        }
      }
    },
    "pipelines": {
      "create-schedules" : {
          "pipe" : "read-schedules | load-folder-uuid | dumpthis "
      }
    },
    "services": { },
    "startup": {
      "exec": "create-schedules"
    }
  }
}
