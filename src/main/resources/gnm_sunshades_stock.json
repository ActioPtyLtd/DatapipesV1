{
  "script": {
    "schema": {},
    "tasks": {
      "read-product-api": {
        "type": "extract",
        "behavior": "",
        "dataSource": {
          "type": "rest",
          "behavior": "simple",
          "path": "https://api.sunshad.es/v1/stock",
          "credential": {
            "user": "gm",
            "password": "83498dd4fa301a3aa2d117b13d371526"
          },
          "query": {
            "read": {
              "uri": "https://api.sunshad.es/v1/stock"
            }
          }
        }
      },
      "pick-items": {
        "type": "transformTerm",
        "term": "batch(items)"
      },
      "stock-template": {
        "type": "mergeTemplate",
        "templates": {
          "update-uri": "https://dev-api-gnm.actio.com.au:8443/service/product/SUNSHADES/$stockid/stock",
          "update-body": "{\"supplier_id\": \"SUNSHADES\",\"retail_price\": $retail_price,\"retail_price_tax\": $retail_price_tax,\"alias_prefix\":\"SUNSHADES\",\"alias_id\": \"$stockid\",\"quantity\": $supplier_total,\"wholesale_price\": $wholesale_price,\"wholesale_price_tax\": $wholesale_price_tax}"
        }
      },
      "iterate": {
        "type": "transformTerm",
        "term": "ds => ds"
      },
      "update-stock-api": {
        "type": "load",
        "behavior": "update",
        "dataSource": {
          "type": "rest",
          "behavior": "simple",
          "path": "-",
          "credential": {
            "user": "admin",
            "password": "password"
          },
          "query": {
            "update": {
              "uri": "update-uri",
              "body": "update-body"
            }
          }
        }
      }
    },
    "pipelines": {
      "load-stock" : {
        "pipe": "read-product-api | pick-items | stock-template | iterate | update-stock-api"
      }
    },
    "services": { },
    "startup": {
      "exec": "load-stock"
    }
  }
}
